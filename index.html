<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Data Aset Suryatokoku</title>

<style>
body{
  font-family:Arial;
  background:#f4f6f9;
  padding:20px;
}

h1{
  text-align:center;
  color:#0a2a66;
}

.container{
  max-width:1000px;
  margin:auto;
}

.topbar{
  display:flex;
  justify-content:space-between;
  margin-bottom:15px;
}

button{
  background:#0a2a66;
  color:white;
  padding:10px 15px;
  border:none;
  cursor:pointer;
  border-radius:6px;
}

button:hover{
  background:#081f4d;
}

table{
  width:100%;
  border-collapse:collapse;
  background:white;
}

th, td{
  border:1px solid #ddd;
  padding:8px;
}

th{
  background:#0a2a66;
  color:white;
  text-align:center;   /* header kolom center */
}

td{
  text-align:left;     /* isi data tetap rapi kiri */
}

tr:hover{
  background:#eef2ff;
}
</style>

</head>
<body>

<div class="container">

<h1>DATA ASET SURYATOKOKU</h1>

<div class="topbar">
  <div></div>
  <button onclick="window.location.href='tambah.html'">
    ‚ûï Tambah Aset
  </button>
</div>

<table id="asetTable">
  <thead></thead>
  <tbody></tbody>
</table>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw2LrYiqBzd4HpGb7EfikPg4vjRCfExfZFGqmjLi25398sqicLS31aTX_8Oe84b1j7W/exec";

function loadData(){
fetch(API_URL)
.then(res => res.json())
.then(data => {

  const head = document.querySelector("#asetTable thead");
  const body = document.querySelector("#asetTable tbody");

  body.innerHTML="";

  let headers = Object.keys(data[0]).filter(h=>h!="rowIndex");

  head.innerHTML = "<tr>" +
    headers.map(h => `<th>${h}</th>`).join("") +
    "<th>Action</th></tr>";

  data.forEach(row => {
    let tr="<tr>";

    headers.forEach(h => {
      tr+=`<td>${row[h] ?? ""}</td>`;
    });

    tr += `
      <td style="text-align:center">
        <button onclick='editData(${JSON.stringify(row)})'>‚úèÔ∏è</button>
        <button onclick='deleteData(${row.rowIndex})'>üóë</button>
      </td>
    `;

    tr+="</tr>";
    body.innerHTML+=tr;
  });

});
}

loadData();

// DELETE
function deleteData(rowIndex){
  if(!confirm("Hapus aset ini?")) return;

  fetch(API_URL,{
    method:"DELETE",
    body: JSON.stringify({rowIndex})
  })
  .then(()=> loadData());
}

// EDIT
function editData(row){
  const nama = prompt("Nama Barang:", row["Nama Barang"]);
  if(nama===null) return;

  const kategori = prompt("Kategori:", row["Kategori"]);
  const merk = prompt("Merk & Model:", row["Merk & Model"]);
  const serial = prompt("Serial:", row["Serial Number / IMEI"]);
  const spek = prompt("Spesifikasi:", row["Spesifikasi"]);
  const status = prompt("Status:", row["Status"]);
  const pic = prompt("PIC:", row["Nama Pengguna / PIC"]);
  const lokasi = prompt("Lokasi:", row["Lokasi"]);
  const ket = prompt("Keterangan:", row["Keterangan"]);

  const updated = {
    rowIndex: row.rowIndex,
    No: row.No,
    NamaBarang: nama,
    Kategori: kategori,
    MerkModel: merk,
    Serial: serial,
    Spesifikasi: spek,
    Status: status,
    PIC: pic,
    Lokasi: lokasi,
    Keterangan: ket
  };

  fetch(API_URL,{
    method:"PUT",
    body: JSON.stringify(updated)
  })
  .then(()=> loadData());
}
</script>



</body>
</html>
